"use strict";(self.webpackChunkreact_canonical=self.webpackChunkreact_canonical||[]).push([[792],{8077:(e,t,s)=>{var a=s(4848),r=s(6540),n=s(5338),i=s(7767);const l="EthV0Sfz22gpFO0doxic",d="DoRDvKvgonb42ghZvVgQ";var o=s(7980),c=s(4976);const m=({userName:e})=>(0,a.jsx)("header",{className:"O0FxNoF_l6KrY6RBswIx",children:(0,a.jsxs)("nav",{className:"vwvgrSTqdejaYiOi4dSV p-4",children:[(0,a.jsxs)("div",{className:"FnB8W_D4beaUlEfTopQk",children:[(0,a.jsxs)(c.k2,{to:"/",className:({isActive:e})=>`${l} ${e?d:""}`,children:[(0,a.jsx)(o.Lf,{type:"primary"}),(0,a.jsx)("p",{className:"text text_type_main-default ml-2 mr-10",children:"Конструктор"})]}),(0,a.jsxs)(c.k2,{to:"/feed",className:({isActive:e})=>`${l} ${e?d:""}`,children:[(0,a.jsx)(o.kp,{type:"primary"}),(0,a.jsx)("p",{className:"text text_type_main-default ml-2",children:"Лента заказов"})]})]}),(0,a.jsx)("div",{className:"jYNs8XcDfHmzWxOZ5hKg",children:(0,a.jsx)(c.k2,{to:"/",className:({isActive:e})=>`${l} ${e?d:""}`,children:(0,a.jsx)(o.gu,{className:""})})}),(0,a.jsx)("div",{className:"pkK9BFGHNMQBHMhhStb9",children:(0,a.jsxs)(c.k2,{to:"/profile",className:({isActive:e})=>`${l} ${e?d:""}`,children:[(0,a.jsx)(o.n_,{type:"primary"}),(0,a.jsx)("p",{className:"text text_type_main-default ml-2",children:e||"Личный кабинет"})]})})]})}),u="_W_JfNJJl5H5e8eqr8Ya",x="mJns_Jb07jLke7LQ6UAF",h=({constructorItems:e,orderRequest:t,price:s,orderModalData:r,onOrderClick:n,closeOrderModal:i})=>(0,a.jsxs)("section",{className:"R0Ja10_UixREbmJ6qzGV",children:[e.bun?(0,a.jsx)("div",{className:`${x} mb-4 mr-4`,children:(0,a.jsx)(o.VM,{type:"top",isLocked:!0,text:`${e.bun.name} (верх)`,price:e.bun.price,thumbnail:e.bun.image})}):(0,a.jsx)("div",{className:`${u} OF4tMG36q2aG7QGwf6XA ml-8 mb-4 mr-5 text text_type_main-default`,children:"Выберите булки"}),(0,a.jsx)("ul",{className:"HEJ0tV35JHL7iuHL89vk",children:e.ingredients.length>0?e.ingredients.map(((t,s)=>(0,a.jsx)(He,{ingredient:t,index:s,totalItems:e.ingredients.length},t.id))):(0,a.jsx)("div",{className:`${u} ml-8 mb-4 mr-5 text text_type_main-default`,children:"Выберите начинку"})}),e.bun?(0,a.jsx)("div",{className:`${x} mt-4 mr-4`,"data-cy":"cyBun",children:(0,a.jsx)(o.VM,{type:"bottom",isLocked:!0,text:`${e.bun.name} (низ)`,price:e.bun.price,thumbnail:e.bun.image})}):(0,a.jsx)("div",{className:`${u} utZ2B1QgZOCmNRbEQvPA ml-8 mb-4 mr-5 text text_type_main-default`,children:"Выберите булки"}),(0,a.jsxs)("div",{className:"v6FmKfAJu8mT_upHDK3A mt-10 mr-4","data-cy":"cyBtnOrder",children:[(0,a.jsxs)("div",{className:"HvvSFpSFQAuy_vX3eOYU mr-10",children:[(0,a.jsx)("p",{className:"text zsm0TegHwEKtU2E2I4R9 mr-2",children:s}),(0,a.jsx)(o.px,{type:"primary"})]}),(0,a.jsx)(o.$n,{htmlType:"button",type:"primary",size:"large",children:"Оформить заказ",onClick:n})]}),t&&(0,a.jsx)(nt,{onClose:i,title:"Оформляем заказ...",children:(0,a.jsx)(P,{})}),r&&(0,a.jsx)(nt,{onClose:i,title:t?"Оформляем заказ...":"",children:(0,a.jsx)(O,{orderNumber:r.number})})]}),p=(0,r.memo)((({ingredient:e,index:t,totalItems:s,handleMoveUp:r,handleMoveDown:n,handleClose:i})=>(0,a.jsxs)("li",{className:"pI008xZIIooxWwNA5NJT mb-4 mr-2","data-cy":"cyMain",children:[(0,a.jsx)(o.g3,{handleMoveDown:n,handleMoveUp:r,isUpDisabled:0===t,isDownDisabled:t===s-1}),(0,a.jsx)("div",{className:"Hf3gHktDVu9C__6KCbWX ml-2",children:(0,a.jsx)(o.VM,{text:e.name,price:e.price,thumbnail:e.image,handleClose:i})})]}))),g={container:"szzp3k0uBXITrGixPLCJ",article:"J2V21wcp5ddf6wQCcqXv",cost:"YBYW9kjYHyQOpQXO7Dcg",text:"mZUnvup1IrMo87DtOf2Q",addButton:"HR_H4Fj42ZLB21Nz5vxx"},j=(0,r.memo)((({ingredient:e,count:t,handleAdd:s,locationState:r})=>{const{image:n,price:i,name:l,_id:d}=e;return(0,a.jsxs)("li",{className:g.container,"data-cy":e._id,children:[(0,a.jsxs)(c.N_,{className:g.article,to:`/ingredients/${d}`,state:r,"data-cy":"cyCard",children:[t&&(0,a.jsx)(o.ph,{count:t}),(0,a.jsx)("img",{className:g.img,src:n,alt:"картинка ингредиента."}),(0,a.jsxs)("div",{className:`${g.cost} mt-2 mb-2`,children:[(0,a.jsx)("p",{className:"text text_type_digits-default mr-2",children:i}),(0,a.jsx)(o.px,{type:"primary"})]}),(0,a.jsx)("p",{className:`text text_type_main-default ${g.text}`,children:l})]}),(0,a.jsx)(o.M3,{text:"Добавить",onClick:s,extraClass:`${g.addButton} mt-8`})]})})),f=(0,r.memo)((({currentTab:e,buns:t,mains:s,sauces:r,titleBunRef:n,titleMainRef:i,titleSaucesRef:l,bunsRef:d,mainsRef:c,saucesRef:m,onTabClick:u})=>(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("section",{className:"gWGQQO_DR2tGAz6JfTJw",children:[(0,a.jsx)("nav",{children:(0,a.jsxs)("ul",{className:"JS5hWmZCChXepOtq58RV",children:[(0,a.jsx)(o.oz,{value:"bun",active:"bun"===e,onClick:u,children:"Булки"}),(0,a.jsx)(o.oz,{value:"main",active:"main"===e,onClick:u,children:"Начинки"}),(0,a.jsx)(o.oz,{value:"sauce",active:"sauce"===e,onClick:u,children:"Соусы"})]})}),(0,a.jsxs)("div",{className:"nwANerpzIt6nknkv21Qj",children:[(0,a.jsx)(st,{title:"Булки",titleRef:n,ingredients:t,ref:d}),(0,a.jsx)(st,{title:"Начинки",titleRef:i,ingredients:s,ref:c}),(0,a.jsx)(st,{title:"Соусы",titleRef:l,ingredients:r,ref:m})]})]})}))),y="ISTKLfT0GntaQ5VnHFPC",N=(0,r.memo)((({feed:e,readyOrders:t,pendingOrders:s})=>{const{total:r,totalToday:n}=e;return(0,a.jsxs)("section",{children:[(0,a.jsxs)("div",{className:"JpHt9uBwbWxOTwVqFyeh",children:[(0,a.jsx)(b,{orders:t,title:"Готовы",textColor:"blue"}),(0,a.jsx)(b,{orders:s,title:"В работе"})]}),(0,a.jsx)(_,{title:"Выполнено за все время",content:r}),(0,a.jsx)(_,{title:"Выполнено за сегодня",content:n})]})})),b=({orders:e,title:t,textColor:s})=>(0,a.jsxs)("div",{className:"pr-6 xKALonXP3gCzxtKM4tpi",children:[(0,a.jsxs)("h3",{className:`text text_type_main-medium ${y}`,children:[t,":"]}),(0,a.jsx)("ul",{className:"pt-6  LjaB7a4JqWnCdfSGztaK",children:e.map(((e,t)=>(0,a.jsx)("li",{className:"text text_type_digits-default _pz0rXzUQJNiKbLsZLq8",style:{color:"blue"===s?"#00cccc":"#F2F2F3"},children:e},t)))})]}),_=({title:e,content:t})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("h3",{className:`pt-15 text text_type_main-medium ${y}`,children:[e,":"]}),(0,a.jsx)("p",{className:"text text_type_digits-large ZGmTFeuQACm37s_bvpp9",children:t})]}),v={content:"G7XCxXE59ujtXU1FO7W1",nutritional_values:"B0JUjcExseGqzRkCpU1a",nutritional_value:"kN70k9ogAM8Gr4giJiw3"},C=(0,r.memo)((({ingredientData:e})=>{const{name:t,image_large:s,calories:r,proteins:n,fat:i,carbohydrates:l}=e;return(0,a.jsxs)("div",{className:v.content,children:[(0,a.jsx)("img",{className:v.img,alt:"изображение ингредиента.",src:s}),(0,a.jsx)("h3",{className:"text text_type_main-medium mt-2 mb-4",children:t}),(0,a.jsxs)("ul",{className:`${v.nutritional_values} text_type_main-default`,children:[(0,a.jsxs)("li",{className:v.nutritional_value,children:[(0,a.jsx)("p",{className:`text mb-2 ${v.text}`,children:"Калории, ккал"}),(0,a.jsx)("p",{className:"text text_type_digits-default",children:r})]}),(0,a.jsxs)("li",{className:v.nutritional_value,children:[(0,a.jsx)("p",{className:`text mb-2 ${v.text}`,children:"Белки, г"}),(0,a.jsx)("p",{className:"text text_type_digits-default",children:n})]}),(0,a.jsxs)("li",{className:v.nutritional_value,children:[(0,a.jsx)("p",{className:`text mb-2 ${v.text}`,children:"Жиры, г"}),(0,a.jsx)("p",{className:"text text_type_digits-default",children:i})]}),(0,a.jsxs)("li",{className:v.nutritional_value,children:[(0,a.jsx)("p",{className:`text mb-2 ${v.text}`,children:"Углеводы, г"}),(0,a.jsx)("p",{className:"text text_type_digits-default",children:l})]})]})]})})),k=(0,r.forwardRef)((({title:e,titleRef:t,ingredients:s,ingredientsCounters:r},n)=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:"text text_type_main-medium mt-10 mb-6",ref:t,children:e}),(0,a.jsx)("ul",{className:"TschaSuz4Fx6SIwt3Bs9",ref:n,children:s.map((e=>(0,a.jsx)(Xe,{ingredient:e,count:r[e._id]},e._id)))})]}))),T={modal:"xqsNTMuGR8DdWtMkOGiM",header:"b_7mdKCbZ9NwpuNYvKgW",button:"Z7mUFPBZScxutAKTLKHN",img:"Xrfu2WsdJstkmEhahoH0",content:"kymTVSFEObODAY4TavAl"},S=(0,r.memo)((({title:e,onClose:t,children:s})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:T.modal,"data-cy":"cyModal",children:[(0,a.jsxs)("div",{className:T.header,children:[(0,a.jsx)("h3",{className:`${T.title} text text_type_main-large`,children:e}),(0,a.jsx)("button",{className:T.button,type:"button","data-cy":"closeModal",children:(0,a.jsx)(o.US,{type:"primary",onClick:t})})]}),(0,a.jsx)("div",{className:T.content,children:s})]}),(0,a.jsx)(w,{onClick:t})]}))),w=({onClick:e})=>(0,a.jsx)("div",{className:"RuQycGaRTQNbnIEC5d3Y",onClick:e,"data-cy":"cyOverlay"}),$={ingredients:"HuTb1Lniz8Hj8eAZ5Qw4",order:"etVry7SAVcyyKn90udyc",order_info:"xLbn59QeknXY3Kb9nDMt",order_name:"MBOehSm03BZO0wNDVXQl",order_content:"jXsHA95E0ms2MpB177Xn",order_total:"bKKZWBRRWjIpFYlDsrze",img_wrap:"xSak7l8BrDxjh2Pjvdb3",img:"fp2IRZ7Exp0DSOzkWIMe",remains:"Y0SKajHftdO1DqtgfKGA"},I=(0,r.memo)((({orderInfo:e,maxIngredients:t,locationState:s})=>(0,a.jsxs)(c.N_,{to:e.number.toString(),relative:"path",state:s,className:`p-6 mb-4 mr-2 ${$.order}`,children:[(0,a.jsxs)("div",{className:$.order_info,children:[(0,a.jsxs)("span",{className:`text text_type_digits-default ${$.number}`,children:["#",String(e.number).padStart(6,"0")]}),(0,a.jsx)("span",{className:"text text_type_main-default text_color_inactive",children:(0,a.jsx)(o.XU,{date:e.date})})]}),(0,a.jsx)("h4",{className:`pt-6 text text_type_main-medium ${$.order_name}`,children:e.name}),"/profile/orders"===location.pathname&&(0,a.jsx)(ot,{status:e.status}),(0,a.jsxs)("div",{className:`pt-6 ${$.order_content}`,children:[(0,a.jsx)("ul",{className:$.ingredients,children:e.ingredientsToShow.map(((s,r)=>{let n=t-r,i=20*r;return(0,a.jsxs)("li",{className:$.img_wrap,style:{zIndex:n,right:i},children:[(0,a.jsx)("img",{style:{opacity:e.remains&&t===r+1?"0.5":"1"},className:$.img,src:s.image_mobile,alt:s.name}),t===r+1?(0,a.jsx)("span",{className:`text text_type_digits-default ${$.remains}`,children:e.remains>0?`+${e.remains}`:null}):null]},r)}))}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:`text text_type_digits-default pr-1 ${$.order_total}`,children:e.total}),(0,a.jsx)(o.px,{type:"primary"})]})]})]}))),A=s.p+"assets/85c3a14da4759ed44774.svg",O=({orderNumber:e})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"U070UGjz0x5J0l3NxX3I text text_type_digits-large mt-2 mb-4",children:e}),(0,a.jsx)("p",{className:"text text_type_main-medium",children:"идентификатор заказа"}),(0,a.jsx)("img",{className:"nPuIgvJzcXKIqep2W3Aw",src:A,alt:"изображение статуса заказа."}),(0,a.jsx)("p",{className:"text text_type_main-default mb-1",children:"Ваш заказ начали готовить"}),(0,a.jsx)("p",{className:"y8tkPMt_X6GP_fNZE6eL text text_type_main-default",children:"Дождитесь готовности на орбитальной станции"})]}),z=(0,r.memo)((({orderInfo:e})=>(0,a.jsxs)("div",{className:"Q4U4VNAEk4qukLWVLMvL",children:[(0,a.jsx)("h3",{className:"text text_type_main-medium  pb-3 pt-10 DAIr7jAwLrNpLxQakdxa",children:e.name}),(0,a.jsx)(ot,{status:e.status}),(0,a.jsx)("p",{className:"text text_type_main-medium pt-15 pb=6",children:"Состав:"}),(0,a.jsx)("ul",{className:"d3_j_X9kkozQMF_EmDAg mb-8",children:Object.values(e.ingredientsInfo).map(((e,t)=>(0,a.jsxs)("li",{className:"pb-4 pr-6 lquK_3i8pYhiInuPUd2s",children:[(0,a.jsx)("div",{className:"OYdOhIiiipHQp3GBrBhz",children:(0,a.jsx)("div",{className:"yF1v1L0FQ4vINreDg4eX",children:(0,a.jsx)("img",{className:"fWkAza3wjkhLda02deZM",src:e.image_mobile,alt:e.name})})}),(0,a.jsx)("span",{className:"text text_type_main-default pl-4",children:e.name}),(0,a.jsxs)("span",{className:"text text_type_digits-default pl-4 pr-4 qarD_AODNDU6WicOIKwU",children:[e.count," x ",e.price]}),(0,a.jsx)(o.px,{type:"primary"})]},t)))}),(0,a.jsxs)("div",{className:"zZIJdpI4avPsKuVJTtpt",children:[(0,a.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:(0,a.jsx)(o.XU,{date:e.date})}),(0,a.jsx)("span",{className:"text text_type_digits-default pr-4 MsUa4HjM22cIZPRLCa9v",children:e.total}),(0,a.jsx)(o.px,{type:"primary"})]})]}))),D=({textStyle:e,text:t})=>(0,a.jsx)("span",{className:"text text_type_main-default pt-2",style:{color:e},children:t}),E=({orderByDate:e})=>(0,a.jsx)("div",{className:"d3cqH8yvGgEgYbMLHUVl",children:e.map((e=>(0,a.jsx)(it,{order:e},e._id)))}),P=()=>(0,a.jsx)("div",{className:"ly51abty9fh3PyjJVbzw",children:(0,a.jsx)("div",{className:"LYgcN2ZXp55AsWMX0kwJ"})}),R="JahrNDfOGyRN7ZrEg1TK",L="gZcjBq95C7Xas0ZOOQdK",B=({pathname:e,handleLogout:t})=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.k2,{to:"/profile",className:({isActive:e})=>`text text_type_main-medium text_color_inactive pt-4 pb-4 ${R} ${e?L:""}`,end:!0,children:"Профиль"}),(0,a.jsx)(c.k2,{to:"/profile/orders",className:({isActive:e})=>`text text_type_main-medium text_color_inactive pt-4 pb-4 ${R} ${e?L:""}`,children:"История заказов"}),(0,a.jsx)("button",{className:"text text_type_main-medium text_color_inactive pt-4 pb-4 q960G55JMeVVYQQ4TfAl",onClick:t,children:"Выход"}),(0,a.jsx)("p",{className:"pt-20 text text_type_main-default text_color_inactive",children:"/profile"===e?"В этом разделе вы можете изменить свои персональные данные":"В этом разделе вы можете просмотреть свою историю заказов"})]});function F(e){const t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function M(e,t,s={}){let a=(s={path:"/",...s}).expires;if(a&&"number"==typeof a){const e=new Date;e.setTime(e.getTime()+1e3*a),a=s.expires=e}a&&a instanceof Date&&(s.expires=a.toUTCString());let r=e+"="+(t=encodeURIComponent(t));for(const e in s){r+="; "+e;const t=s[e];!0!==t&&(r+="="+t)}document.cookie=r}const U="https://norma.nomoreparties.space/api",V=e=>e.ok?e.json():e.json().then((e=>Promise.reject(e))),Z=async(e,t)=>{try{const s=await fetch(e,t);return await V(s)}catch(s){if("jwt expired"===s.message){const s=await fetch(`${U}/auth/token`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({token:localStorage.getItem("refreshToken")})}).then((e=>V(e))).then((e=>e.success?(localStorage.setItem("refreshToken",e.refreshToken),M("accessToken",e.accessToken),e):Promise.reject(e)));t.headers&&(t.headers.authorization=s.accessToken);const a=await fetch(e,t);return await V(a)}return Promise.reject(s)}},J=e=>fetch(`${U}/password-reset`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((e=>V(e))).then((e=>e?.success?e:Promise.reject(e))),q=e=>fetch(`${U}/password-reset/reset`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((e=>V(e))).then((e=>e?.success?e:Promise.reject(e)));var K=s(7088);const Q=(0,K.zD)("user/getUser",(()=>Z(`${U}/auth/user`,{headers:{authorization:F("accessToken")}}))),H=(0,K.zD)("user/register",(async({email:e,name:t,password:s})=>{const a=await(e=>fetch(`${U}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((e=>V(e))).then((e=>e?.success?e:Promise.reject(e))))({email:e,name:t,password:s});return M("accessToken",a.accessToken),localStorage.setItem("refreshToken",a.refreshToken),a})),X=(0,K.zD)("user/login",(async({email:e,password:t})=>{const s=await(e=>fetch(`${U}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)}).then((e=>V(e))).then((e=>e?.success?e:Promise.reject(e))))({email:e,password:t});return M("accessToken",s.accessToken),localStorage.setItem("refreshToken",s.refreshToken),s})),G=(0,K.zD)("user/forgot",(async e=>await J({email:e}))),W=(0,K.zD)("user/reset",(async({password:e,token:t})=>await q({password:e,token:t}))),Y=(0,K.zD)("user/update",(async e=>{const t=await(e=>Z(`${U}/auth/user`,{method:"PATCH",headers:{"Content-Type":"application/json;charset=utf-8",authorization:F("accessToken")},body:JSON.stringify(e)}))(e);return t})),ee=(0,K.zD)("user/logout",(async()=>{await fetch(`${U}/auth/logout`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({token:localStorage.getItem("refreshToken")})}).then((e=>V(e))),localStorage.removeItem("refreshToken"),M("accessToken","",{expires:-1})})),te=(0,K.Z0)({name:"user",initialState:{loading:!1,error:null,isAuthenticated:!1,user:null,isAuthChecked:!1},reducers:{},extraReducers:e=>{e.addCase(Q.pending,(e=>{e.loading=!0,e.error=null,e.isAuthenticated=!1})).addCase(Q.fulfilled,((e,t)=>{t.payload.user?(e.user=t.payload.user,e.isAuthenticated=!0,e.isAuthChecked=!0):e.user=null,e.loading=!1})).addCase(Q.rejected,((e,t)=>{e.loading=!1,e.isAuthenticated=!1,e.error=t.error?.message||"Не получены данные от пользователя",e.isAuthChecked=!0})).addCase(H.pending,(e=>{e.loading=!0,e.error=null})).addCase(H.fulfilled,((e,t)=>{e.loading=!1,e.isAuthenticated=!0,e.user=t.payload.user,e.isAuthChecked=!0})).addCase(H.rejected,((e,t)=>{e.loading=!1,e.error=t.error?.message||"Ошибка при регистрации",e.isAuthChecked=!0})).addCase(X.pending,(e=>{e.loading=!0,e.isAuthenticated=!1,e.error=null})).addCase(X.fulfilled,((e,t)=>{e.loading=!1,e.isAuthenticated=!0,e.user=t.payload.user,e.error=null,e.isAuthChecked=!0})).addCase(X.rejected,((e,t)=>{e.loading=!1,e.isAuthenticated=!1,e.error=t.error?.message||"Ошибка при входе",e.isAuthChecked=!0})).addCase(G.pending,(e=>{e.loading=!0,e.error=null})).addCase(G.fulfilled,(e=>{e.loading=!1})).addCase(G.rejected,((e,t)=>{e.loading=!1,e.error=t.error?.message||"Ошибка при восстановлении пароля"})).addCase(W.pending,(e=>{e.loading=!0,e.error=null})).addCase(Y.rejected,((e,t)=>{e.loading=!1,e.isAuthChecked=!0,e.error=t.error?.message||"Ошибка при обновлении данных"})).addCase(ee.fulfilled,(e=>{e.loading=!1,e.user=null,e.isAuthChecked=!0,e.isAuthenticated=!1})).addCase(W.fulfilled,(e=>{e.loading=!1})).addCase(W.rejected,((e,t)=>{e.loading=!1,e.error=t.error?.message||"Ошибка при сбросе пароля"})).addCase(Y.pending,(e=>{e.loading=!0,e.error=null})).addCase(Y.fulfilled,((e,t)=>{e.loading=!1,e.isAuthenticated=!0,e.isAuthChecked=!0,e.user=t.payload.user})).addCase(ee.rejected,((e,t)=>{e.loading=!1,e.isAuthChecked=!0,e.isAuthenticated=!0,e.error=t.error.message||"Ошибка выхода"}))},selectors:{getUserSelect:e=>e.user,getLoading:e=>e.loading,isAuthenticatedSelect:e=>e.isAuthenticated,isAuthCheckedSelector:e=>e.isAuthChecked}}),se=te.reducer,{getUserSelect:ae,getLoading:re,isAuthenticatedSelect:ne,isAuthCheckedSelector:ie}=te.selectors;var le=s(4644),de=s(1468);const oe=(0,K.zD)("ingredients/getIngredients",(()=>fetch(`${U}/ingredients`).then((e=>V(e))).then((e=>e?.success?e.data:Promise.reject(e))))),ce=(0,K.Z0)({name:"ingredients",initialState:{ingredients:[],loading:!1,error:null},reducers:{},selectors:{getIngredientsLoadingState:e=>e.loading,getIngredients:e=>e.ingredients},extraReducers:e=>{e.addCase(oe.pending,(e=>{e.loading=!0,e.error=null})).addCase(oe.fulfilled,((e,t)=>{e.loading=!1,e.ingredients=t.payload})).addCase(oe.rejected,((e,t)=>{e.loading=!1,e.error=t.error.message||"Failed to get ingredients"}))}}),me=ce.reducer,{getIngredientsLoadingState:ue,getIngredients:xe}=ce.selectors,he=(0,K.Z0)({name:"burgerConstructor",initialState:{ingredients:[],bun:null},reducers:{addBunsandIngredients:{reducer:(e,t)=>{"bun"===t.payload.type?e.bun=t.payload:e.ingredients.push(t.payload)},prepare:e=>({payload:{...e,id:(0,K.Ak)()}})},deleteIngredients:(e,t)=>{e.ingredients=e.ingredients.filter((e=>e.id!==t.payload))},moveIngredient:(e,t)=>{const{from:s,to:a}=t.payload,r=e.ingredients[s];e.ingredients.splice(s,1),e.ingredients.splice(a,0,r)},resetConstructor:e=>{e.ingredients=[],e.bun=null}},selectors:{getIngredients:e=>e.ingredients,getBun:e=>e.bun,getBurgerSelect:e=>e}}),{addBunsandIngredients:pe,deleteIngredients:ge,resetConstructor:je,moveIngredient:fe}=he.actions,ye=he.reducer,{getIngredients:Ne,getBun:be,getBurgerSelect:_e}=he.selectors,ve=(0,K.zD)("order/newOrder",(e=>Z(`${U}/orders`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",authorization:F("accessToken")},body:JSON.stringify({ingredients:e})}).then((e=>e?.success?e:Promise.reject(e))))),Ce=(0,K.Z0)({name:"order",initialState:{loading:!1,order:null,error:null},reducers:{clearOrder:e=>{e.order=null}},selectors:{getOrderRequest:e=>e.loading,getOrderModalData:e=>e.order},extraReducers:e=>{e.addCase(ve.pending,(e=>{e.loading=!0,e.error=null})).addCase(ve.fulfilled,((e,t)=>{e.loading=!1,e.order=t.payload.order})).addCase(ve.rejected,((e,t)=>{e.loading=!1,e.error=t.error.message||"Failed to get order"}))}}),ke=Ce.reducer,{getOrderRequest:Te,getOrderModalData:Se}=Ce.selectors,{clearOrder:we}=Ce.actions,$e=(0,K.zD)("order/allOrders",(()=>Z(`${U}/orders`,{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8",authorization:F("accessToken")}}).then((e=>e?.success?e.orders:Promise.reject(e))))),Ie=(0,K.zD)("order/orderByNumber",(e=>fetch(`${U}/orders/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>V(e))))),Ae=(0,K.Z0)({name:"orders",initialState:{orders:[],orderByNumber:null,error:null,loading:!1},reducers:{},selectors:{getListOrdersSelector:e=>e.orders,getOrderByNumberSelector:e=>e.orderByNumber,getLoading:e=>e.loading},extraReducers:e=>{e.addCase($e.pending,(e=>{e.loading=!0,e.error=null})).addCase(Ie.pending,(e=>{e.loading=!0,e.error=null})).addCase(Ie.fulfilled,((e,t)=>{e.loading=!1,e.orderByNumber=t.payload.orders[0]})).addCase($e.fulfilled,((e,t)=>{e.loading=!1,e.orders=t.payload})).addCase($e.rejected,((e,t)=>{e.loading=!1,e.error=t.error.message||"Ошбика загрузки"})).addCase(Ie.rejected,((e,t)=>{e.loading=!1,e.error=t.error.message||"Ошибка  получения заказа"}))}}),{getListOrdersSelector:Oe,getOrderByNumberSelector:ze}=Ae.selectors,De=Ae.reducer,Ee=(0,K.zD)("orders/getFeed",(()=>fetch(`${U}/orders/all`).then((e=>V(e))).then((e=>e?.success?e:Promise.reject(e))))),Pe=(0,K.Z0)({name:"feed",initialState:{loading:!1,orders:[],error:null,total:0,totalToday:0},reducers:{},selectors:{getFeedLoading:e=>e.loading,getFeedSelect:e=>e.orders,getAllTotal:e=>e.total,getTodayTotal:e=>e.totalToday},extraReducers:e=>{e.addCase(Ee.pending,(e=>{e.loading=!0,e.error=null})).addCase(Ee.rejected,((e,t)=>{e.loading=!1,e.error=t.error.message||"Ошибка в получении ленты заказов"})).addCase(Ee.fulfilled,((e,t)=>{e.loading=!1,e.orders=t.payload.orders,e.total=t.payload.total,e.totalToday=t.payload.totalToday}))}}),Re=Pe.reducer,{getFeedLoading:Le,getFeedSelect:Be,getAllTotal:Fe,getTodayTotal:Me}=Pe.selectors,Ue=(0,le.HY)({ingredients:me,burgerConstructor:ye,order:ke,orders:De,feed:Re,user:se}),Ve=(0,K.U1)({reducer:Ue,devTools:!1}),Ze=()=>(0,de.wA)(),Je=de.d4,qe=Ve,Ke=()=>{const e=Je(ae),t=e?.name||"";return(0,a.jsx)(m,{userName:t})},Qe=()=>{const e=Ze(),t=Je(be),s=Je(Ne),n=Je(ne),l=(0,i.Zp)(),d={bun:t,ingredients:s},o=Je(Te),c=Je(Se),m=(0,r.useMemo)((()=>(d.bun?2*d.bun.price:0)+d.ingredients.reduce(((e,t)=>e+t.price),0)),[d]);return(0,a.jsx)(h,{price:m,orderRequest:o,constructorItems:d,orderModalData:c,onOrderClick:()=>{if(d.bun&&!o)if(n){const t=[d.bun._id,...d.ingredients.map((e=>e._id))];e(ve(t))}else l("/login")},closeOrderModal:()=>{e(we()),e(je())}})},He=(0,r.memo)((({ingredient:e,index:t,totalItems:s})=>{const r=Ze();return(0,a.jsx)(p,{ingredient:e,index:t,totalItems:s,handleMoveUp:()=>{t>0&&r(fe({from:t,to:t-1}))},handleMoveDown:()=>{t<s-1&&r(fe({from:t,to:t+1}))},handleClose:()=>r(ge(e.id))})})),Xe=(0,r.memo)((({ingredient:e,count:t})=>{const s=(0,i.zy)(),r=Ze();return(0,a.jsx)(j,{ingredient:e,count:t,locationState:{background:s},handleAdd:()=>{r(pe(e))}})}));var Ge=s(7695);const We=()=>{const e=Je(xe),t=e.filter((e=>"bun"===e.type)),s=e.filter((e=>"main"===e.type)),n=e.filter((e=>"sauce"===e.type)),[i,l]=(0,r.useState)("bun"),d=(0,r.useRef)(null),o=(0,r.useRef)(null),c=(0,r.useRef)(null),[m,u]=(0,Ge.Wx)({threshold:0}),[x,h]=(0,Ge.Wx)({threshold:0}),[p,g]=(0,Ge.Wx)({threshold:0});return(0,r.useEffect)((()=>{u?l("bun"):g?l("sauce"):h&&l("main")}),[u,h,g]),(0,a.jsx)(f,{currentTab:i,buns:t,mains:s,sauces:n,titleBunRef:d,titleMainRef:o,titleSaucesRef:c,bunsRef:m,mainsRef:x,saucesRef:p,onTabClick:e=>{l(e),"bun"===e&&d.current?.scrollIntoView({behavior:"smooth"}),"main"===e&&o.current?.scrollIntoView({behavior:"smooth"}),"sauce"===e&&c.current?.scrollIntoView({behavior:"smooth"})}})},Ye=(e,t)=>e.filter((e=>e.status===t)).map((e=>e.number)).slice(0,20),et=()=>{const e=Je(Be),t={total:Je(Fe),totalToday:Je(Me)},s=Ye(e,"done"),r=Ye(e,"pending");return(0,a.jsx)(N,{readyOrders:s,pendingOrders:r,feed:t})},tt=()=>{const{id:e}=(0,i.g)(),t=Je(xe).find((t=>t._id===e));return t?(0,a.jsx)(C,{ingredientData:t}):(0,a.jsx)(P,{})},st=(0,r.forwardRef)((({title:e,titleRef:t,ingredients:s},n)=>{const i=Je(_e),l=(0,r.useMemo)((()=>{const{bun:e,ingredients:t}=i,s={};return t.forEach((e=>{s[e._id]||(s[e._id]=0),s[e._id]++})),e&&(s[e._id]=2),s}),[i]);return(0,a.jsx)(k,{title:e,titleRef:t,ingredients:s,ingredientsCounters:l,ref:n})}));var at=s(961);const rt=document.getElementById("modals"),nt=(0,r.memo)((({title:e,onClose:t,children:s})=>((0,r.useEffect)((()=>{const e=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[t]),at.createPortal((0,a.jsx)(S,{title:e,onClose:t,children:s}),rt)))),it=(0,r.memo)((({order:e})=>{const t=(0,i.zy)(),s=Je(xe),n=(0,r.useMemo)((()=>{if(!s.length)return null;const t=e.ingredients.reduce(((e,t)=>{const a=s.find((e=>e._id===t));return a?[...e,a]:e}),[]),a=t.reduce(((e,t)=>e+t.price),0),r=t.slice(0,6),n=t.length>6?t.length-6:0,i=new Date(e.createdAt);return{...e,ingredientsInfo:t,ingredientsToShow:r,remains:n,total:a,date:i}}),[e,s]);return n?(0,a.jsx)(I,{orderInfo:n,maxIngredients:6,locationState:{background:t}}):null})),lt=()=>{const e=Je(xe),t=Ze(),{number:s}=(0,i.g)(),n=Je(ze);(0,r.useEffect)((()=>{s&&t(Ie(Number(s)))}),[]);const l=(0,r.useMemo)((()=>{if(!n||!e.length)return null;const t=new Date(n.createdAt),s=n.ingredients.reduce(((t,s)=>{if(t[s])t[s].count++;else{const a=e.find((e=>e._id===s));a&&(t[s]={...a,count:1})}return t}),{}),a=Object.values(s).reduce(((e,t)=>e+t.price*t.count),0);return{...n,ingredientsInfo:s,date:t,total:a}}),[n,e]);return l?(0,a.jsx)(z,{orderInfo:l}):(0,a.jsx)(P,{})},dt={pending:"Готовится",done:"Выполнен",created:"Создан"},ot=({status:e})=>{let t="";switch(e){case"pending":t="#E52B1A";break;case"done":t="#00CCCC";break;default:t="#F2F2F3"}return(0,a.jsx)(D,{textStyle:t,text:dt[t]})},ct=(0,r.memo)((({orders:e})=>{const t=[...e].sort(((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()));return(0,a.jsx)(E,{orderByDate:t})})),mt=()=>{const{pathname:e}=(0,i.zy)(),t=Ze(),s=(0,i.Zp)();return(0,a.jsx)(B,{handleLogout:()=>{t(ee()),s("/")},pathname:e})},ut=()=>(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("main",{className:"rT96vXsx4Cc2cLrNWt5h",children:[(0,a.jsx)("h1",{className:"VE2QTNovEFok85vl1V8A text text_type_main-large mt-10 mb-5 pl-5",children:"Соберите бургер"}),(0,a.jsxs)("div",{className:"oRJKB4wIRrzdy80OQfg6 pl-5 pr-5",children:[(0,a.jsx)(We,{}),(0,a.jsx)(Qe,{})]})]})}),xt={containerMain:"Zb2IWNVwMo3lKTfcqm6c",titleBox:"Go1cNxTA_Sn4QRrDUbC_",main:"uU5iKR4avuT86s8mlhSj",columnOrders:"ar3RH_BQbYrJ4nToVbzD",columnInfo:"Bn0UUpCP0E4RpAaOxIT5"},ht=(0,r.memo)((({orders:e,handleGetFeeds:t})=>(0,a.jsxs)("main",{className:xt.containerMain,children:[(0,a.jsxs)("div",{className:`${xt.titleBox} mt-10 mb-5`,children:[(0,a.jsx)("h1",{className:`${xt.title} text text_type_main-large`,children:"Лента заказов"}),(0,a.jsx)(o.sv,{text:"Обновить",onClick:t,extraClass:"ml-30"})]}),(0,a.jsxs)("div",{className:xt.main,children:[(0,a.jsx)("div",{className:xt.columnOrders,children:(0,a.jsx)(ct,{orders:e})}),(0,a.jsx)("div",{className:xt.columnInfo,children:(0,a.jsx)(et,{})})]})]}))),pt="RkV4SUYtE7ZluuGVJ3eQ",gt="RfOC6y1vx3EYZQfju1YM",jt="UWHo8nvwgPkkt7UZdh_k",ft="SKa60su6kt5kaFVouYzV",yt="Itv3S6X9InYUJKO7siSn",Nt="I8nibrKn0Wor_ZXRYmre",bt="VHT4gpVnG1yYmr1cVhSK",_t=({errorText:e,email:t,setEmail:s,handleSubmit:r})=>(0,a.jsx)("main",{className:pt,children:(0,a.jsxs)("div",{className:`pt-6 ${gt}`,children:[(0,a.jsx)("h3",{className:"pb-6 text text_type_main-medium",children:"Восстановление пароля"}),(0,a.jsxs)("form",{className:`pb-15 ${jt}`,name:"login",onSubmit:r,children:[(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.pd,{type:"email",placeholder:"Укажите e-mail",onChange:e=>s(e.target.value),value:t,name:"email",error:!1,errorText:"",size:"default",onPointerEnterCapture:()=>{},onPointerLeaveCapture:()=>{}})}),(0,a.jsx)("div",{className:`pb-6 ${ft}`,children:(0,a.jsx)(o.$n,{type:"primary",size:"medium",htmlType:"submit",children:"Восстановить"})}),e&&(0,a.jsx)("p",{className:`${bt} text text_type_main-default pb-6`,children:e})]}),(0,a.jsxs)("div",{className:`${yt} text text_type_main-default pb-6`,children:["Вспомнили пароль?",(0,a.jsx)(c.N_,{to:"/login",className:`pl-2 ${Nt}`,children:"Войти"})]})]})}),vt=({email:e,setEmail:t,errorText:s,handleSubmit:r,password:n,setPassword:i})=>(0,a.jsx)("main",{className:pt,children:(0,a.jsxs)("div",{className:`pt-6 ${gt}`,children:[(0,a.jsx)("h3",{className:"pb-6 text text_type_main-medium",children:"Вход"}),(0,a.jsx)("form",{className:`pb-15 ${jt}`,name:"login",onSubmit:r,children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.pd,{type:"email",placeholder:"E-mail",onChange:e=>t(e.target.value),value:e,name:"email",error:!1,errorText:"",size:"default",onPointerEnterCapture:()=>{},onPointerLeaveCapture:()=>{}})}),(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.yA,{onChange:e=>i(e.target.value),value:n,name:"password"})}),(0,a.jsx)("div",{className:`pb-6 ${ft}`,children:(0,a.jsx)(o.$n,{type:"primary",size:"medium",htmlType:"submit",children:"Войти"})}),s&&(0,a.jsx)("p",{className:`${bt} text text_type_main-default pb-6`,children:s})]})}),(0,a.jsxs)("div",{className:`pb-4 ${yt} text text_type_main-default`,children:["Вы - новый пользователь?",(0,a.jsx)(c.N_,{to:"/register",className:`pl-2 ${Nt}`,children:"Зарегистрироваться"})]}),(0,a.jsxs)("div",{className:`${yt} text text_type_main-default pb-6`,children:["Забыли пароль?",(0,a.jsx)(c.N_,{to:"/forgot-password",className:`pl-2 ${Nt}`,children:"Восстановить пароль"})]})]})}),Ct={menu:"UGQrwgoduNDw2SvF9uYf",form:"KgHq3OVo9PkZs7ugHX_o"},kt=({formValue:e,isFormChanged:t,updateUserError:s,handleSubmit:r,handleCancel:n,handleInputChange:i})=>(0,a.jsxs)("main",{className:`${pt}`,children:[(0,a.jsx)("div",{className:`mt-30 mr-15 ${Ct.menu}`,children:(0,a.jsx)(mt,{})}),(0,a.jsx)("form",{className:`mt-30 ${Ct.form} ${jt}`,onSubmit:r,children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.pd,{type:"text",placeholder:"Имя",onChange:i,value:e.name,name:"name",error:!1,errorText:"",size:"default",icon:"EditIcon",onPointerEnterCapture:()=>{},onPointerLeaveCapture:()=>{}})}),(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.pd,{type:"email",placeholder:"E-mail",onChange:i,value:e.email,name:"email",error:!1,errorText:"",size:"default",icon:"EditIcon",onPointerEnterCapture:()=>{},onPointerLeaveCapture:()=>{}})}),(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.pd,{type:"password",placeholder:"Пароль",onChange:i,value:e.password,name:"password",error:!1,errorText:"",size:"default",icon:"EditIcon",onPointerEnterCapture:()=>{},onPointerLeaveCapture:()=>{}})}),t&&(0,a.jsxs)("div",{className:Ct.button,children:[(0,a.jsx)(o.$n,{type:"secondary",htmlType:"button",size:"medium",onClick:n,children:"Отменить"}),(0,a.jsx)(o.$n,{type:"primary",size:"medium",htmlType:"submit",children:"Сохранить"})]}),s&&(0,a.jsx)("p",{className:`${bt} pt-5 text text_type_main-default`,children:s})]})})]}),Tt=({orders:e})=>(0,a.jsxs)("main",{className:"fODhAWrSpfImy3Z8lXeN",children:[(0,a.jsx)("div",{className:"mt-30 mr-15 PLgSZXjunonCj8GpyT0p",children:(0,a.jsx)(mt,{})}),(0,a.jsx)("div",{className:"mt-10 BILBqbCySK5FV342wjQ6",children:(0,a.jsx)(ct,{orders:e})})]}),St=({errorText:e,email:t,setEmail:s,handleSubmit:r,password:n,setPassword:i,userName:l,setUserName:d})=>(0,a.jsx)("main",{className:pt,children:(0,a.jsxs)("div",{className:`pt-6 ${gt}`,children:[(0,a.jsx)("h3",{className:"pb-6 text text_type_main-medium",children:"Регистрация"}),(0,a.jsx)("form",{className:`pb-15 ${jt}`,name:"register",onSubmit:r,children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.pd,{type:"text",placeholder:"Имя",onChange:e=>d(e.target.value),value:l,name:"name",error:!1,errorText:"",size:"default",onPointerEnterCapture:()=>{},onPointerLeaveCapture:()=>{}})}),(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.pd,{type:"email",placeholder:"E-mail",onChange:e=>s(e.target.value),value:t,name:"email",error:!1,errorText:"",size:"default",onPointerEnterCapture:()=>{},onPointerLeaveCapture:()=>{}})}),(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.yA,{onChange:e=>i(e.target.value),value:n,name:"password"})}),(0,a.jsx)("div",{className:`pb-6 ${ft}`,children:(0,a.jsx)(o.$n,{type:"primary",size:"medium",htmlType:"submit",children:"Зарегистрироваться"})}),e&&(0,a.jsx)("p",{className:`${bt} text text_type_main-default pb-6`,children:e})]})}),(0,a.jsxs)("div",{className:`${yt} text text_type_main-default pb-6`,children:["Уже зарегистрированы?",(0,a.jsx)(c.N_,{to:"/login",className:`pl-2 ${Nt}`,children:"Войти"})]})]})}),wt=({errorText:e,password:t,setPassword:s,handleSubmit:r,token:n,setToken:i})=>(0,a.jsx)("main",{className:pt,children:(0,a.jsxs)("div",{className:`pt-6 ${gt}`,children:[(0,a.jsx)("h3",{className:"pb-6 text text_type_main-medium",children:"Восстановление пароля"}),(0,a.jsxs)("form",{className:`pb-15 ${jt}`,name:"login",onSubmit:r,children:[(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.yA,{onChange:e=>s(e.target.value),value:t,name:"password"})}),(0,a.jsx)("div",{className:"pb-6",children:(0,a.jsx)(o.pd,{type:"text",placeholder:"Введите код из письма",onChange:e=>i(e.target.value),value:n,name:"token",error:!1,errorText:"",size:"default",onPointerEnterCapture:()=>{},onPointerLeaveCapture:()=>{}})}),(0,a.jsx)("div",{className:`pb-6 ${ft}`,children:(0,a.jsx)(o.$n,{type:"primary",size:"medium",htmlType:"submit",children:"Сохранить"})}),e&&(0,a.jsx)("p",{className:`${bt} text text_type_main-default pb-6`,children:e})]}),(0,a.jsxs)("div",{className:`${yt} text text_type_main-default pb-6`,children:["Вспомнили пароль?",(0,a.jsx)(c.N_,{to:"/login",className:`pl-2 ${Nt}`,children:"Войти"})]})]})}),$t=()=>{const e=Je(Be),t=Ze();return(0,r.useEffect)((()=>{t(Ee())}),[t]),e.length?(0,a.jsx)(ht,{orders:e,handleGetFeeds:()=>{t(Ee())}}):(0,a.jsx)(P,{})},It=()=>{const[e,t]=(0,r.useState)(""),[s,n]=(0,r.useState)(null),l=(0,i.Zp)();return(0,a.jsx)(_t,{errorText:s?.message,email:e,setEmail:t,handleSubmit:t=>{t.preventDefault(),n(null),J({email:e}).then((()=>{localStorage.setItem("resetPassword","true"),l("/reset-password",{replace:!0})})).catch((e=>n(e)))}})},At=()=>{const[e,t]=(0,r.useState)(""),[s,n]=(0,r.useState)(""),i=Ze();return(0,a.jsx)(vt,{errorText:"",email:e,setEmail:t,password:s,setPassword:n,handleSubmit:t=>{t.preventDefault(),i(X({email:e,password:s}))}})},Ot=()=>(0,a.jsx)("h3",{className:"pb-6 text text_type_main-large",children:"Страница не найдена. Ошибка 404."}),zt=()=>{const e=Je(ae),t=Ze(),[s,n]=(0,r.useState)({name:e?.name||"",email:e?.email||"",password:""});(0,r.useEffect)((()=>{n((t=>({...t,name:e?.name||"",email:e?.email||""})))}),[e]);const i=s.name!==e?.name||s.email!==e?.email||!!s.password;return(0,a.jsx)(kt,{formValue:s,isFormChanged:i,handleCancel:t=>{t.preventDefault(),n({name:e?.name||"",email:e?.email||"",password:""})},handleSubmit:e=>{e.preventDefault(),t(Y(s))},handleInputChange:e=>{n((t=>({...t,[e.target.name]:e.target.value})))}})},Dt=()=>{const e=Je(Oe),t=Ze();return(0,r.useEffect)((()=>{t($e())})),(0,a.jsx)(Tt,{orders:e})},Et=()=>{const[e,t]=(0,r.useState)(""),[s,n]=(0,r.useState)(""),[i,l]=(0,r.useState)(""),d=Ze();return(0,a.jsx)(St,{errorText:"",email:s,userName:e,password:i,setEmail:n,setPassword:l,setUserName:t,handleSubmit:t=>{t.preventDefault(),s&&e&&i&&d(H({email:s,name:e,password:i}))}})},Pt=()=>{const e=(0,i.Zp)(),[t,s]=(0,r.useState)(""),[n,l]=(0,r.useState)(""),[d,o]=(0,r.useState)(null);return(0,r.useEffect)((()=>{localStorage.getItem("resetPassword")||e("/forgot-password",{replace:!0})}),[e]),(0,a.jsx)(wt,{errorText:d?.message,password:t,token:n,setPassword:s,setToken:l,handleSubmit:s=>{s.preventDefault(),o(null),q({password:t,token:n}).then((()=>{localStorage.removeItem("resetPassword"),e("/login")})).catch((e=>o(e)))}})},Rt=({children:e,isUserLoggedIn:t})=>{const s=(0,i.zy)(),r=Je(ie),n=Je(ae);if(!r)return(0,a.jsx)(P,{});if(!t&&!n)return(0,a.jsx)(i.C5,{to:"/login",state:{from:s}});if(t&&n){const{from:e}=s.state??{from:{pathname:"/"}};return(0,a.jsx)(i.C5,{to:e})}return e},Lt=document.getElementById("root");n.H(Lt).render((0,a.jsx)(r.StrictMode,{children:(0,a.jsx)(de.Kq,{store:qe,children:(0,a.jsx)(c.Kd,{basename:"/stellar-burgers",children:(0,a.jsx)((()=>{const e=(0,i.zy)(),t=(0,i.Zp)(),s=Ze(),n=e.state?.background,l=()=>{t(-1)};return(0,r.useEffect)((()=>{s(oe()),s(Q())}),[]),(0,a.jsxs)("div",{className:"DV2uvu6KgvySTJAsLpyQ",children:[(0,a.jsx)(Ke,{}),(0,a.jsxs)(i.BV,{location:n||e,children:[(0,a.jsx)(i.qh,{path:"/",element:(0,a.jsx)(ut,{})}),(0,a.jsx)(i.qh,{path:"/feed",element:(0,a.jsx)($t,{})}),(0,a.jsx)(i.qh,{path:"/feed/:number",element:(0,a.jsx)(lt,{})}),(0,a.jsx)(i.qh,{path:"/ingredients/:id",element:(0,a.jsx)(tt,{})}),(0,a.jsx)(i.qh,{path:"/login",element:(0,a.jsx)(Rt,{isUserLoggedIn:!0,children:(0,a.jsx)(At,{})})}),(0,a.jsx)(i.qh,{path:"/register",element:(0,a.jsx)(Rt,{isUserLoggedIn:!0,children:(0,a.jsx)(Et,{})})}),(0,a.jsx)(i.qh,{path:"/forgot-password",element:(0,a.jsx)(Rt,{isUserLoggedIn:!0,children:(0,a.jsx)(It,{})})}),(0,a.jsx)(i.qh,{path:"/reset-password",element:(0,a.jsx)(Rt,{isUserLoggedIn:!0,children:(0,a.jsx)(Pt,{})})}),(0,a.jsx)(i.qh,{path:"/profile",element:(0,a.jsx)(Rt,{children:(0,a.jsx)(zt,{})})}),(0,a.jsx)(i.qh,{path:"/profile/orders",element:(0,a.jsx)(Rt,{children:(0,a.jsx)(Dt,{})})}),(0,a.jsx)(i.qh,{path:"/profile/orders/:number",element:(0,a.jsx)(Rt,{children:(0,a.jsx)(lt,{})})}),(0,a.jsx)(i.qh,{path:"*",element:(0,a.jsx)(Ot,{})})]}),n&&(0,a.jsxs)(i.BV,{children:[(0,a.jsx)(i.qh,{path:"/ingredients/:id",element:(0,a.jsx)(nt,{title:"Детали ингредиента",onClose:l,children:(0,a.jsx)(tt,{})})}),(0,a.jsx)(i.qh,{path:"/feed/:number",element:(0,a.jsx)(nt,{title:"",onClose:l,children:(0,a.jsx)(lt,{})})}),(0,a.jsx)(i.qh,{path:"/profile/orders/:number",element:(0,a.jsx)(Rt,{children:(0,a.jsx)(nt,{title:"",onClose:l,children:(0,a.jsx)(lt,{})})})})]})]})}),{})})})}))}},e=>{e.O(0,[193],(()=>e(e.s=8077))),e.O()}]);